<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://chenyoupu.top</id>
    <title>有朴的第二大脑</title>
    <updated>2023-11-13T06:44:04.717Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://chenyoupu.top"/>
    <link rel="self" href="https://chenyoupu.top/atom.xml"/>
    <subtitle>Hi，这里是有朴的第二大脑。&lt;br/&gt;很高兴与你相遇</subtitle>
    <logo>https://chenyoupu.top/images/avatar.png</logo>
    <icon>https://chenyoupu.top/favicon.ico</icon>
    <rights>All rights reserved 2023, 有朴的第二大脑</rights>
    <entry>
        <title type="html"><![CDATA[「Pangenome tutorial」Pangenie｜Graph-based genotyping]]></title>
        <id>https://chenyoupu.top/post/pangenome-tutorial-001/</id>
        <link href="https://chenyoupu.top/post/pangenome-tutorial-001/">
        </link>
        <updated>2023-11-13T06:41:22.000Z</updated>
        <content type="html"><![CDATA[<h2 id="intropan-genie能做什么">Intro｜Pan-Genie能做什么？</h2>
<ul>
<li>
<p>PanGenie is a pangenome-based genotyper using short-read data. <u>It computes genotypes for variants represented as bubbles in a pangenome graph by taking information of already known haplotypes</u> (represented as paths through the graph) into account. It can only genotype diploid individuals. The required input files are described in detail below.</p>
<p>总结来说，</p>
<ul>
<li>PanGenie不是variant caller，<strong>而是genotyping类的工具</strong>（同时只能针对二倍体物种来做）</li>
</ul>
</li>
</ul>
<h2 id="pangenie软件安装">Pangenie｜软件安装</h2>
<p>作者给出了两种方式来安装，</p>
<ul>
<li>singularity</li>
<li>conda/mamba，但还是需要一个编译的过程</li>
</ul>
<pre><code class="language-bash">git clone https://github.com/eblerjana/pangenie.git  
cd pangenie  
conda env create -f environment.yml  
conda activate pangenie   
mkdir build; cd build; cmake .. ; make

# mamba activate pangenie
</code></pre>
<p>Short Notes:</p>
<ul>
<li>还是可以在x86架构的机器上正常运行的（arm64有待测试）<img src="https://youpu777-assets-1308187048.cos.ap-shanghai.myqcloud.com/siyuan-notes/WeChatfd0f8a18e30001e3992aada1d04d8981.jpg" alt="" loading="lazy"></li>
<li>Pangenie依赖的是jellyfish，也是一款非常经典的k-mer genomics software了</li>
</ul>
<h2 id="pangenie输入文件准备">Pangenie｜输入文件准备</h2>
<h3 id="01pan-genome-graph-in-variants-format">01）pan-genome graph in variants format</h3>
<p>pangenie需要的variants file有以下几个特点（其本质上是从构建pan-genome graph过程中产生的VCF中获得），</p>
<ul>
<li>
<p><strong>multi-sample</strong>：包含多条resolvde haplotype，且至少有一条haplotype的sample info是已知的</p>
</li>
<li>
<p><strong>fully-phased</strong>：举个例子，hifiasm过程中产生的两条phased haplotype即可</p>
</li>
<li>
<p><strong>non-overlapping variants</strong>：由于基于pan-genome graph产生得到的variants在physical position上存在重叠，而这一类是不可以作为pangenie的输入数据的</p>
</li>
<li>
<p><strong>sequence-resolved</strong>：需要清晰地保存了REF allele和ALT allele信息，像2015年Evan Eichler它们发布的结果不可以作为pangenie的输入文件（no information about REF &amp; ALT）</p>
<p><a href="https://www.internationalgenome.org/phase-3-structural-variant-dataset">www.internationalgenome....</a></p>
</li>
</ul>
<p>针对第三点，pangenie官方给出的示意格式，</p>
<figure data-type="image" tabindex="1"><img src="https://github.com/eblerjana/pangenie/raw/master/images/input-representation.png" alt="" loading="lazy"></figure>
<p>准备上述variants file的格式如下，</p>
<ul>
<li>
<p><a href="https://bitbucket.org/jana_ebler/vcf-merging/src/master/">bitbucket.org/jana_ebler...</a></p>
</li>
<li>
<p>also see <a href="https://github.com/eblerjana/pangenie/wiki">Wiki</a> for different ways to generate VCFs</p>
</li>
<li>
<p>1）vcfbub</p>
<pre><code class="language-bash"># 如何过滤准备得到对应的pan-genie input vcf
vcfbub -l 0 -r 100000 --input &lt;your-vcf-file&gt; &gt; pangenie-ready.vcf
</code></pre>
</li>
<li>
<p>2）针对mini-cactus分析得到的vcf，<a href="https://github.com/eblerjana/genotyping-pipelines/tree/main/prepare-vcf-MC">github.com/eblerjana/gen...</a></p>
<p>该pipeline的两种特点，</p>
<ul>
<li>vcfbub + addtional annotation（for downstream analysis）</li>
</ul>
</li>
<li>
<p>3）再者使用的是其他软件（e.g., PAV, developed by Evan），则可以使用pangenie自带的pipeline来进行merge和过滤，</p>
<p><a href="https://github.com/eblerjana/pangenie/tree/master/pipelines/run-from-callset">github.com/eblerjana/pan...</a>，该流程基于snakemake</p>
</li>
</ul>
<p>Short Notes：</p>
<ul>
<li>
<p>哪些VCF是无法满足上述数据的数据要求？</p>
<p>Note again that the haplotypes must be phased into a single phased block. So phased VCFs generated by phasing tools like <strong>WhatsHap</strong> are not suitable!</p>
</li>
</ul>
<h3 id="02short-reads-input">02）short reads input</h3>
<h3 id="03reference-genome">03）reference genome</h3>
<h2 id="pangeniedemo">Pangenie｜demo</h2>
<pre><code class="language-bash">PanGenie-index -r test-reference.fa -v test-variants.vcf -o preprocessing -e 100000
PanGenie -f preprocessing -i test-reads.fa -o test -e 100000
</code></pre>
<ul>
<li>
<p>结果文件，</p>
<p><code>test_genotyping.vcf</code>：与输入variants保留着相同的REF &amp; ALT，但是基于k-mer的genotyping算法重新估计了如下的三个参数，</p>
<p>1）<strong>additional genotype predictions</strong>；</p>
<p>2）genotype likelihoods；</p>
<p>3）genotype qualities；</p>
<figure data-type="image" tabindex="2"><img src="https://youpu777-assets-1308187048.cos.ap-shanghai.myqcloud.com/siyuan-notes/WeChat0fce19e0c0147b6fe7f86def41cc0573.jpg" alt="" loading="lazy"></figure>
</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[「Pangenome tutorial」vg｜utilizing pangenome graph with variation graph]]></title>
        <id>https://chenyoupu.top/post/pangenome-tutorial-002/</id>
        <link href="https://chenyoupu.top/post/pangenome-tutorial-002/">
        </link>
        <updated>2023-11-13T06:38:00.000Z</updated>
        <content type="html"><![CDATA[<h2 id="background">Background</h2>
<ul>
<li>
<p>graph的数据结构</p>
<ul>
<li>
<p><em>nodes</em>, which are labeled by sequences and ids</p>
</li>
<li>
<p><em>edges</em>, which connect two nodes via either of their respective ends</p>
</li>
<li>
<p><em>paths</em>, describe genomes, sequence alignments, and annotations (such as gene models and transcripts) as <strong>walks through</strong> nodes connected by edges</p>
<ul>
<li>Paths provide coordinate systems relative to genomes encoded in the graph, allowing stable mappings to be produced even if the structure of the graph is changed.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="vginstall">vg｜Install</h2>
<pre><code class="language-shell">git clone --recursive https://github.com/vgteam/vg.git
cd vg

# MacOS系统下安装对应的dependencies——使用bundle
# Install all the dependencies in the Brewfile
brew bundle

. ./source_me.sh &amp;&amp; make
</code></pre>
<h2 id="vgvariation-graph-construction">vg｜variation graph construction</h2>
<ul>
<li>
<p>说中文就是构图，将linear genome转变为grpah genome的形式</p>
</li>
<li>
<p>vg也同时支持多种输入格式来构建variation graph</p>
<ul>
<li>
<p><code>PackedGraph (.vg)</code>：<code>vg's</code> native format，支持各类操作（topology和paths内容的修改），但是在大样本时可能效率低下</p>
</li>
<li>
<p><code>GFA (.gfa)</code>：graph sequence的通用结果（中枢结构），text形式，方便在各个pangenome软件中作为中转</p>
<ul>
<li>
<p>vg直接操作gfa的前提是自动转变为PackedGraph来进行操作（暗箱）</p>
<p><code>vg</code> can also operate on (<strong>uncompressed</strong>) GFA files directly, by way of using a <code>PackedGraph</code> representation in memory (and therefore shares that format's scaling concerns and edit-ability).</p>
</li>
</ul>
</li>
<li>
<p><code>GBZ (.gbz)</code>：highly-compressed graph format（不允许任何操作）</p>
<ul>
<li>GBZ格式将reference graph和haplotype graph给区分，比如HPRC中hg38和t2t是作为reference graph，而剩余assembly haplotype则是作为haplotype graph</li>
</ul>
</li>
</ul>
</li>
<li>
<p>vg默认使用1.1版本的gfa，<a href="https://github.com/GFA-spec/GFA-spec/blob/master/GFA1.md#w-walk-line-since-v11">GFA v1.1</a></p>
</li>
</ul>
<h3 id="1vg-constructfrom-vcf">1）<code>vg construct</code>｜from vcf</h3>
<ul>
<li>
<p>需要以提前joint calling得到的variation information作为index来输入，作为graph的基础（fa + vcf）</p>
</li>
<li>
<p>vcf需要index</p>
<pre><code class="language-shell">tabix -p vcf x.vcf.gz
</code></pre>
</li>
</ul>
<pre><code class="language-shell">vg construct -r small/x.fa -v small/x.vcf.gz &gt;x.vg
</code></pre>
<ul>
<li><code>-r</code>，<code>--reference</code></li>
<li><code>-v</code>，<code>--vcf</code></li>
</ul>
<h4 id="2vg-constructfrom-assembly">2）<code>vg construct</code>｜from assembly</h4>
<ul>
<li>比如使用Minigraph-Cactus构建得到的gfa：<a href="https://github.com/ComparativeGenomicsToolkit/cactus/blob/master/doc/pangenome.md">github.com/ComparativeGe...</a></li>
</ul>
<h4 id="-vg-autoindexbuild-graph-index">-）<code>vg autoindex</code>｜build graph &amp; index</h4>
<h4 id="-vg-convert-g">-）<code>vg convert -g</code></h4>
<ul>
<li>将ODGI和PGGB的grpah形式转变为vg格式</li>
</ul>
<h4 id="-vg-convert-f">-）<code>vg convert -f</code></h4>
<ul>
<li>
<p>将任意格式的graph转为gfa格式</p>
</li>
<li>
<p>W-lines和P-lines代表了使用不同的字母表示paths，若需要使用P来代表paths则使用<code>vg convert -fW</code></p>
<blockquote>
<p>P-lines对应gfa 1.0版本</p>
</blockquote>
</li>
</ul>
<h2 id="vgmapping">vg｜mapping</h2>
<h3 id="1vg-giraffe">1）<code>vg giraffe</code></h3>
<ul>
<li>fast for highly accurate short reads, against graphs with haplotype information.</li>
<li>在进行giraffe mapping之前，首先需要构建graph的index（使用<code>vg autoindex</code>）</li>
</ul>
<pre><code class="language-shell"># 0. simulate short reads
# simulate a bunch of 150bp reads from the graph, into a GAM file of reads aligned to a graph
vg sim -n 1000 -l 150 -x x.giraffe.gbz -a &gt; x.sim.gam


# 1. construct the graph and indexes (paths below assume running from `vg/test` directory)
vg autoindex --workflow giraffe -r small/x.fa -v small/x.vcf.gz -p x

[vg autoindex] Executing command: vg autoindex --workflow giraffe -r small/x.fa -v small/x.vcf.gz -p x
[IndexRegistry]: Checking for phasing in VCF(s).
[IndexRegistry]: Chunking inputs for parallelism.
[IndexRegistry]: Constructing VG graph from FASTA and VCF input.
[IndexRegistry]: Constructing GBWT from VG graph and phased VCF input.
[IndexRegistry]: Stripping allele paths from VG.
[IndexRegistry]: Constructing XG graph from VG graph.
[IndexRegistry]: Downsampling full GBWT.
[IndexRegistry]: Not enough haplotypes; augmenting the full GBWT instead.
[IndexRegistry]: Constructing GBZ.
[IndexRegistry]: Constructing distance index for Giraffe.
[IndexRegistry]: Constructing minimizer index.


# 2. remap: using **gam** as the input for the giraffe
# Notes: 
# - 这一部分的逻辑可以理解为基于linear得到的BAM分析得到了对应的VCF——完成graph的构建
# - BAM转为GAM，比对到graph上再重新得到BAM
# now re-map these reads against the graph, and get BAM output in linear space
# FASTQ input uses -f instead of -G.
vg giraffe -Z x.giraffe.gbz -G x.sim.gam -o BAM &gt; aln.bam

# 需要得index文件：x.min，x.dist
Guessing that x.min is Minimizers
Guessing that x.dist is Giraffe Distance Index
warning:[vg::get_sequence_dictionary] No reference-sense paths available in the graph; falling back to generic paths.
</code></pre>
<ul>
<li>
<p><code>vg sim</code>：基于graph来simulate reads</p>
<ul>
<li>-n <code>--num-reads</code>；-l <code>--read-length</code>；-x <code>--xg-name</code>，输入的graph；-a <code>--align-out</code>，输出为gam format的文件</li>
</ul>
</li>
<li>
<p><code>vg giraffe</code>：graph-based short reads mapping</p>
<ul>
<li><code>-o</code>，根据后缀名输出结果比对文件</li>
<li>如果以fastq作为输入，则需要使用<code>-f</code>而不是<code>-G</code></li>
</ul>
</li>
</ul>
<h3 id="2vg-map">2）<code>vg map</code></h3>
<ul>
<li>
<p>基于kmer的算法将graph分chunk，构建index；且在mapping过程中，所使用的kmer size一定需要小于构建graph index的kmer size</p>
<blockquote>
<p>graph kmer size和mapping kmer size如何影响比对的准确率？</p>
<p><strong>需要锻炼自己的测试数据的能力</strong></p>
</blockquote>
<p>When mapping, any kmer size shorter than that used in the index can be employed, and by default the mapper will decrease the kmer size to increase sensitivity when alignment at a particular <em>k</em> fails.</p>
</li>
</ul>
<pre><code class="language-shell"># 1. construct the graph (paths below assume running from `vg/test` directory)
# Notes: 注意此处生成的是x.vg
vg construct -r small/x.fa -v small/x.vcf.gz &gt; x.vg

# 2. store the graph in the xg/gcsa index pair
# Notes: 
# - 使用k=16来构建index
# - x.gcsa，即输出`.gcsa`类型的index
# - 最终得到的是 xg/gcsa格式的index pairs
vg index -x x.xg -g x.gcsa -k 16 x.vg

# 3.1 align a read to the indexed version of the graph
# note that the graph file is not opened, but x.vg.index is assumed
vg map -s CTACTGACAGCAGAAGTTTGCTGTGAAGATTAAATTAGGTGATGCTTG -x x.xg -g x.gcsa &gt; read.gam

# 3.2 simulate a bunch of 150bp reads from the graph, one per line
vg sim -n 1000 -l 150 -x x.xg &gt; x.sim.txt
# now map these reads against the graph to get a GAM
vg map -T x.sim.txt -x x.xg -g x.gcsa &gt; aln.gam

# 4.1 surject the alignments back into the reference space of sequence &quot;x&quot;, yielding a BAM file
# Notes: 将vg map生成的gam文件重新比对到graph中的reference path上，生成得到BAM文件
vg surject -x x.xg -b aln.gam &gt; aln.bam

# 4.2 surject them to BAM in the call to map
# Notes: 在使用vg map比对的时候就可以直接生成bam文件
vg sim -n 1000 -l 150 -x x.xg &gt; x.sim.txt
vg map -T x.sim.txt -x x.xg -g x.gcsa --surject-to bam &gt; aln.bam
</code></pre>
<ul>
<li>
<p><code>vg index</code></p>
<ul>
<li>-x，<code>--xg-name</code>：use this file to store a succinct, queryable version of the graph(s), or read for GCSA or distance indexing</li>
<li>-g，<code>--gcsa-out</code>：output a GCSA2 index to the given file</li>
</ul>
</li>
<li>
<p><code>vg sim</code></p>
<ul>
<li>默认情况下生成text格式的sequence，一行一条序列</li>
</ul>
</li>
<li>
<p><code>vg map</code></p>
<ul>
<li>默认生产的格式为gam</li>
<li>-T，<code>--reads</code>：take reads (one per line) from FILE, write alignments to stdout</li>
<li>-x + -g，输入index pairs</li>
</ul>
</li>
</ul>
<h2 id="vgvariant-calling">vg｜variant calling</h2>
<h3 id="1calling-variants-with-read-support">1）calling variants with read support</h3>
<ul>
<li>
<p>当前对SV得准确率更高</p>
</li>
<li>
<p>Operating on <code>.vg</code> or '.gfa' uses the most memory and is not recommended for large graphs.</p>
</li>
<li>
<p>1）<code>pack</code>：获得gam文件中的reads depth信息</p>
<ul>
<li><code>-x</code>，代表输入的graph</li>
<li><code>-Q 5</code>代表过滤mapping quality小于5的read mapping结果</li>
</ul>
</li>
<li>
<p>2）<code>call</code></p>
<ul>
<li>默认情况下输出到STDOUT</li>
<li><code>-k</code>，<code>--pack</code>：supports created from vg pack for given input graph（reads support文件的输入flag）</li>
</ul>
</li>
</ul>
<p>只针对graph中的variants进行calling，</p>
<pre><code class="language-shell"># Compute the read support from the gam
# -Q 5: ignore mapping and base qualitiy &lt; 5
vg pack -x x.xg -g aln.gam -Q 5  -o aln.pack

# Generate a VCF from the support.  
vg call x.xg -k aln.pack &gt; graph_calls.vcf

vg call x.xg -k aln.pack -a &gt; snarl_genotypes.vcf
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[「有谱talk」2023年的就业寒冬与我有什么关系？]]></title>
        <id>https://chenyoupu.top/post/youputalk005/</id>
        <link href="https://chenyoupu.top/post/youputalk005/">
        </link>
        <updated>2023-10-29T15:59:30.000Z</updated>
        <content type="html"><![CDATA[<p>周末第一次参加了线下的茶话会，见到了久闻大名但是未闻其人的互联网导师。</p>
<p>茶话会本次的议题主要是关于当前的就业形势以及反观临近毕业的博士生到底能做怎么样的工作？</p>
<p>近几年的行业形式有目共睹，从燃石初期的大批量融资到现在的不断裁员，都反应了疫情以来钱非常难赚的情形。但是于此同时，互联网公司，比如字节、百度、AMZ也都把一定的资金投入了生物医药行业，主要目标当然都是precision medicine，其中不仅囊括了各种类型肿瘤的早筛，当然还包括未来即将大力发展的生物医学大模型。</p>
<p>首先来聊聊互联网导师。本人的互联网导师有很多，有远到在阿美莉卡做data scientist的，也有近到就在上海做博士后的。把技术流和思维流当作一个区间的两头，则可以对我的互联网导师做一个精细的排布。这次碰头的互联网导师，虽然在技术上，我认为没有那么大彪悍（相对的），但是在思维层面上绝对是杠杠的。原因：写的帖子能够很精确的拿捏特定方向的骨架，再逐一展开，描述细节。这种能力看似简单，其实不然，比会几门编程语言要难得多，需要经过不断地训练、反思，才能锻炼出来的“提炼知识”、“直击痛点”的能力，换个角度来看，那就是学术炼金术士。</p>
<p>其次，也就是最重要的部分，再来聊聊这次的收获。结合我最近写文章以及整合项目的经历，我愈发地意识到，只有技术是不够的，思想在技术之上。若要举例论证，奥本海默无疑是近期大家最熟悉的例子。他的计算以及数学能力并不是曼哈顿项目中最出众的，但是他对问题的理解以及直接痛点的能力是极强的，这也是为什么他才是团队的领导人。技术到了一定程度，够用，能够完成自己的目标就行，再到深入，是Geeker，极致的个人体验，倒不一定能够为团队做出贡献。尽管如此，我想表达的不是技术不重要，技术重要，但是当技术掌握到了一定程度之后，思维就显得更加重要了，就好比甄嬛为什么能够在宫斗中胜出，因为思维领先了别人一个层次。此外，技术人员在本土内部没有受到足够的重视也是一个原因：“你不干，总有人会干”这样的理念宛如巨石一般压在了搞技术人的头上，谁还会安心的搞技术。</p>
<p>研究生一年截止到目前，啥都没做出来，但是却让我涨了不少见识，学到了很多东西，提升了自己的综合能力，总归还是在进步。到了年底冲业绩的时候了，该挣扎挣扎，但要保持一个“稳”的内核，就好比甄嬛说的“就算别人瞧不起你，咱也不能瞧不起自己”、“与其羡慕你所向往的，不如成为你所向往的”。</p>
<h2 id="写在后面">写在后面</h2>
<ul>
<li>甄嬛和九菇凉，是目前国产剧中我最喜欢的两位女性角色，有勇有谋。</li>
<li>甄嬛最后一次回宫，心中喊的口号，必是：“都给老娘闪开，别挡着我搞事业”</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[「有谱talk」存档篇｜论科研与生活]]></title>
        <id>https://chenyoupu.top/post/youputalk004/</id>
        <link href="https://chenyoupu.top/post/youputalk004/">
        </link>
        <updated>2023-10-14T07:38:28.000Z</updated>
        <content type="html"><![CDATA[<h2 id="写在前面">写在前面</h2>
<ul>
<li>这部分内容是我大四时所写。近日观觉醒年代有感，则重新发布，供自己回忆与思考。</li>
<li>其中有几个论点颇为无厘头。
<ul>
<li>“有多少人在创新？”</li>
<li>我发现我要的不只是读一个所谓的研究生，拿一个所谓的研究生学历。但是我绝不能成为空喊口号，空谈科研意义之人，找寻其中的热情、激情以及获取知识的快乐，才是我用于与日常生活斗争的源头和动力</li>
<li>生活也很重要，搞钱必然也是目标。没有物质基础，谈何热情与激情？</li>
</ul>
</li>
</ul>
<h2 id="正文">正文</h2>
<p>如果实验室的同学们见第一面就是在吐槽老师怎么怎么样，这样的实验室真的是在科研吗？</p>
<p>实话实说，并不是所有人都想着要搞科研，但是既然选择了读研究生肯定就是要帮老师做好事情的，从分配到自己头上的科研项目中不断训练自己的科研思维和提升自己的能力。</p>
<p>中国现阶段，很多人就是为了读一个研究生，再往更深层次说一些事情，得到了一个好的科研思维上的训练，对以后的工作也是好的，并不是一定为了科研，为什么要如此偏激地想着读博这个事情呢（甚至很多情况下，读博也是为了更好的生存）？如果在读研过程中，发现自己适合科研，那再好不过，因为有多少人能够在自己年轻的时候就意识到自己想做什么呢？</p>
<blockquote>
<p>人在年轻时，最头疼的一件事就是决定自己这一生要做什么。</p>
</blockquote>
<p>科研，说白了也只是一份工作。人们能够因为科研，获得有一份不错的工作，能够过上幸福快乐的日子，那该是多么开心的一件事。</p>
<p>学生不是老师的工具人，学生读书是为了更好地见识这个世界（当然，见识到了世界的黑暗面也是好的），而不是来当老师科研前进路上的一次性垫脚石，用完就丢，用“骗”学生过来干活，这种说法我总觉得有些不对劲。</p>
<p>其本身的想法是好的，在这个大家都在不断地灌水的时代，自己并不想去生产一些东西“同流合污”的产物，如果能遇上抱有如此志向的老师，想必学生对于科研的看法也会提升一个档次，对自己的追求相比也会更高。在如此一个时代，能够追求纯粹事物之人，难得（其实也得分人生的阶段讨论）。</p>
<p>但是，实际情况往往并不如上述情况一样。</p>
<p><strong>真正有多少人在创新？</strong></p>
<p>单纯从科研角度上来看，能够发SCI（并非MPB这种水刊），那似乎是比发中文来的厉害，但是也并没有在实际意义上做到创新，最终发表的工作能否符合“<strong>漂亮的工作</strong>”的标准，我个人认为已经是相当厉害。</p>
<p>因此我认为没有必要踩一捧一，大家追求不一样，大家都有自己生活中所追求的目标，大家都快乐才是最重要的。</p>
<p>为自己的利益考虑，肯定是没有问题，因为人不为己天诛地灭。但是不能过度利己，过度利己会让自己的视野变得越来越狭隘，越来越偏激，做出的事情也越来越不能被周围人所理解（当然，要是想选择不被周围人理解也ok）。</p>
<p>我自己岁数不大，经历的事情不够多，看问题必然存在偏颇，写这篇文章只是想简单表明一下自己的个人观点。</p>
<p>最后祝大家生活开心，工作顺利。</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[「有谱talk」003｜和优柔寡断告别]]></title>
        <id>https://chenyoupu.top/post/youputalk003/</id>
        <link href="https://chenyoupu.top/post/youputalk003/">
        </link>
        <updated>2023-10-09T08:43:21.000Z</updated>
        <content type="html"><![CDATA[<h2 id="小镇错题库">小镇错题库</h2>
<p>高二的时候很迷茫，沉迷于LOL、守望先锋，不知爱为何物，不知道未来的方向在哪里？</p>
<p>许久不见的亲戚关心我的学习，“现在怎么样？”</p>
<p>“感觉找不到对手”，我一眼茫然。</p>
<p>“这么厉害啊”</p>
<p>“不，我排名一百多都快两百了，只是我不知道为何而读书”</p>
<p>是的，曾经的我不喜欢学习，我质疑学习的意义，我不喜欢早读课上，周围同学对英语的态度，“我学习英语难道不是为了来了解各类的文化，丰富自己的见识吗？”，我讨厌死记硬背，我讨厌为了学习而学习。我想要追求的是学习之外的事情。</p>
<p>曾经，可能挺喜欢数学，但是高二的班主任，“<strong>好不好，看高考</strong>”、“要不是因为某某某这个班我都不想教”，我恨透这个人，连带着我也很透数学。看着他肆无忌惮地宣誓着自己的主权，总有一种透不过气的感觉，感觉被自己被淹死在了出水前的最后一刻。</p>
<p>针对这位老师说的话，“好不好，看高考”，我想说我这辈子活的好不好，并不是由一次考试决定的，我就算高考考的不好，我还是可以通过我之后的努力，提升我自己，改善我自己的生活，所以何来“好不好，看高考”一谈。</p>
<p>第一次否定他人对自己的否定。</p>
<h2 id="你和我在人际关系上相差太多了">“你和我在人际关系上相差太多了”</h2>
<p>一段错误的亲密关心，一个有毒的朋友圈，是怎么样影响我的生活的？</p>
<p>我的朋友对我现在的评价是“现在完全看不出来你是个恋爱脑啊！”</p>
<p>我花了四年甚至五年才治好我的恋爱脑。一开始，我认为的爱情，就是完完全全地付出，这样做的初衷是希望对方也会一样对待我。但是并非如此。若掉进了一段并非排他性的、自以为是的亲密关系，对人的伤害是巨大的。</p>
<p>为了某个人，做出怎么样的事，这样的话，在我看来无论如何都很可笑。因为我就曾经为了某个人忍受着一个有毒的朋友圈，让我喘不过气，我认为我在付出，实际上对方看来，这只是你自愿承担的，你自找的。所以，我否定了之前的我：“切勿感动自己”。</p>
<p>当然，我有骄傲的一点，当时别人说我在给定范围内的人之中是最优秀的，当时的我不相信，我用伪装出来的谦虚来掩饰着脆弱的自尊心，认为这样就是优秀。非也。</p>
<p>我需要在我需要展示我的才能的时候，“疯狂地”挥洒汗水，在求知时不拘一格。这是真正的谦虚，而不是时时刻刻的谦虚，这是虚伪。所以，我否定了之前的我：“该展现自己的时候，要展现自己”</p>
<p>经过这所谓的研究生一年级，对我身心、精神上都是一个很大的磨练，面对曾经伤害过我的人，我也不愿意去说，“我原谅你了”、“谢谢你，要不是因为你”这种虚伪的话。</p>
<p>我想说的是，“我失去的，我要全部拿回来，我要复仇”。</p>
<p>我否定了我，否定了那个温顺待人、是个老好人的我。</p>
<p>我否定曾经被否定的自己，我肯定我自己的，一步一步地，等着吧，我失去的，我要亲手拿回来。</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[内向人的“自救指南”（一）]]></title>
        <id>https://chenyoupu.top/post/innerpersion1/</id>
        <link href="https://chenyoupu.top/post/innerpersion1/">
        </link>
        <updated>2023-10-07T12:54:28.000Z</updated>
        <content type="html"><![CDATA[<p>骨子里的我是一个内向人。不爱与人沟通，更喜欢独处，喜欢自己一个人做自己的事情。</p>
<p>但是这影响我本来的正常生活吗？不影响。因为内向从来都不是一种病，内向只是一种性格特征。而与人social也不是外向人的“特权”，内向人通过训练也是能够学会的。所谓的人情世故，在一个人身上的体现来自两个方面，1）原生家庭的影响，比如父母传授给孩子的技能；2）后天人在环境中的适应而发展出来的技能。注意，这只是技能，只要是技能，那么就可以通过刻意练习的方式提升，一切皆有规律可循。</p>
<blockquote>
<p>若是为了自己感兴趣的事情去努力，内向的人一样可以很外向。—— 沃滋基·硕得</p>
</blockquote>
<p>总想要结合个人经历，但是总觉得个人经历没有普适性，也越来越不愿意分享自己的所谓见闻。可能是觉得没啥好分享的，更想要自己消化，自己慢慢咀嚼，可能还时时反刍。但总归有很多事情需要自己去努力。</p>
<ul>
<li>
<p>虽然内向的人，在一开始向外时，会很笨拙，但是可以慢慢练习。</p>
<p>因为如果不去向外，有的利益自己就会争取不到，做不到自己想要做的事情，比外向地去和人交流更痛苦，所以就要外向去交流。但是诸如此类的外向交流会很消耗自己的能力，要允许自己停下来，去补充这部分的能量。</p>
</li>
</ul>
<h2 id="写在后面">写在后面</h2>
<ul>
<li>最近在看觉醒年代（是的，我就是不喜欢在跟风看电视剧，我喜欢在这类题材经历过了时间的检验之后，再花费自己的时间），里面有一句话让我印象深刻：“没有钱没有银子，你再大的光芒放不出来”</li>
</ul>
<h2 id="推荐阅读">推荐阅读</h2>
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/547300484">阿巛关于内向的看法</a></li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[「每日知识储备」gene-environment interaction如何影响heritability估计？]]></title>
        <id>https://chenyoupu.top/post/dailykg005/</id>
        <link href="https://chenyoupu.top/post/dailykg005/">
        </link>
        <updated>2023-10-05T08:15:34.000Z</updated>
        <content type="html"><![CDATA[<ul>
<li>
<p>由于gene-environment interaction本身是一种non-linear effects，因此也可以直接从epistasis等类似的non-linear effects类比过来。</p>
<p>比如geneA对lung cancer有影响，但是在正常生活条件下，其对应的odd ratio为1.0，代表在这种环境下，该geneA对lung cancer的病发没有任何影响。但是当individual有吸烟等情况或者一些没有被测量的情况时，该geneA的odd ratio为5.0，则说明在环境因素的影响下，该geneA对lung cancer的发生有了非常大的影响。</p>
</li>
<li>
<p>因此，当没有考虑到对应的环境条件时，有的gene effect就不会被检测到，这就造成了heritability的丧失。</p>
</li>
<li>
<p>参考资料</p>
<ul>
<li>“Ito et al. (1) showed a significant interaction between smoking status and the apurinic/ apyrimidinic endonuclease 1 protein coding gene (APE1) for lung cancer.” (<a href="zotero://select/library/items/TQT89NAX">Murcray et al., 2009, p. 219</a>) (<a href="zotero://open-pdf/library/items/CQS2299L?page=1&amp;annotation=B8RGSAI7">pdf</a>)</li>
<li>“Stern et al. (2) found smoking status to be an effect modifier of the association between the XPD codon 751 polymorphism and risk of bladder cancer.” (<a href="zotero://select/library/items/TQT89NAX">Murcray et al., 2009, p. 219</a>) (<a href="zotero://open-pdf/library/items/CQS2299L?page=1&amp;annotation=W4HMSNRE">pdf</a>)</li>
</ul>
</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[「每日知识储备」对variant calling的一点小误解]]></title>
        <id>https://chenyoupu.top/post/daily004/</id>
        <link href="https://chenyoupu.top/post/daily004/">
        </link>
        <updated>2023-10-05T07:51:32.000Z</updated>
        <content type="html"><![CDATA[<ul>
<li>
<p>以人类参考基因组为例（只提供了一套染色体组的信息，本质是因为同源，两套基本上没有信息上的差异，只存在一些等位基因（即allele）上的差异）</p>
</li>
<li>
<p>图解</p>
<figure data-type="image" tabindex="1"><img src="https://youpu777-assets-1308187048.cos.ap-shanghai.myqcloud.com/siyuan-notes/20231001232054.png" alt="" loading="lazy"></figure>
</li>
</ul>
<h2 id="参考资料">参考资料</h2>
<ul>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzAxOTUxOTM0Nw==&amp;mid=2649798506&amp;idx=1&amp;sn=773a7db5dfd002c53fead86625266af5&amp;chksm=83c1d576b4b65c6057f93a00d62ea41364ccdf53429b1820442f5855a104dde68f4325376722&amp;scene=21#wechat_redirect">人类基因组phasing的原理</a></li>
</ul>
<p><a href="https://zhuanlan.zhihu.com/p/29485987">从零开始完整学习全基因组测序数据分析：第4节构建WGS主流程</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[「每日知识储备」说说我对PCA的理解]]></title>
        <id>https://chenyoupu.top/post/dailykg003/</id>
        <link href="https://chenyoupu.top/post/dailykg003/">
        </link>
        <updated>2023-10-05T05:47:42.000Z</updated>
        <content type="html"><![CDATA[<ul>
<li>
<p>不讲公式，从个人角度来理解PCA到底做了些什么？</p>
</li>
<li>
<p><strong>首先举个例子，解释下为什么要“降维”？</strong></p>
<p>比如当前有10个individual，对他们进行了WGS测序，得到了他们10个人的variants calling结果。想要分析他们在祖源上的远近程度，如何分析？</p>
<p>方法1：针对<strong>SNP1～5</strong>（SNP1，SNP2，...，SNP5），比如用hamming distance，可以计算得到10个individual中有5个individual（A，B，C，D，E）的hamming distance是0～5，而另外5个individual（F，G，H，I，J）与上述5个individual的hamming distance是7～10，那么我们就可以得到两个分群。</p>
<p>但是再换取另一批SNP数据时，比如SNP100～500时，不仅计算量大，还否定了之前的计算结果，那么这10个individual的祖源到底是什么样的呢？</p>
<p>方法2：<strong>针对WGS测序得到的所有variants来重新构建变量</strong>，且保证重新构建的每个变量之间是正交的，即不相关，保证原始数据的损失达到最小（这部分用variance来衡量）</p>
<p>重新构建的第一个变量称为PC1，第二个称为PC2，依此类推。而每个主成分代表的variance是依次减少的。若前两个主成分（或者三个）能够解释原始数据比较高的比例，那么我们对数据降维的目的就达到了。</p>
<p>而individual在两个主成分（或者三个）上的distribution，就在一定程度上代表了他们genetic material的差异</p>
<blockquote>
<ul>
<li>保证重新构建的变量之间是正交，是为了极大限度地提升对原始数据的提取</li>
<li>为什么用variance来衡量，就比如一个标准正态分布，若取它的一个截断分布，那么实际上就损失了一部分方差，因此方差是一个很好的指代信息损失量的指标</li>
</ul>
</blockquote>
</li>
<li>
<p>利用PC来理解regional population structure</p>
<p>当经过PCA重新组合得到的主成分之后，每个主成分的构成实际上是如下的公式，</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mi>C</mi><mn>1</mn><mo>=</mo><mi>β</mi><mo>∗</mo><mi>S</mi><mi>N</mi><msub><mi>P</mi><mn>1</mn></msub><mo>+</mo><mi>β</mi><mo>∗</mo><mi>S</mi><mi>N</mi><msub><mi>P</mi><mn>2</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><mi>β</mi><mo>∗</mo><mi>S</mi><mi>N</mi><msub><mi>P</mi><mn>3</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">PC1 = \beta*SNP_{1} + \beta*SNP_{2} + ... + \beta*SNP_{3} + ...
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.10556em;vertical-align:0em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span></span></p>
<p>则两个individual如果在PC1轴上距离很远，说明它们在用于构建PC1的SNP上具有比较大的差异，但是如果在PC2轴上距离很近，则说明它们在用于构建PC2的SNP上比较相似，可能形成了regional population structure。</p>
</li>
</ul>
<h2 id="推荐阅读">推荐阅读</h2>
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/77151308">阿泽对PCA的讲解，有公式</a></li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[「每日知识储备」GWAS中的effect size是什么？]]></title>
        <id>https://chenyoupu.top/post/dailykg002/</id>
        <link href="https://chenyoupu.top/post/dailykg002/">
        </link>
        <updated>2023-10-05T05:27:58.000Z</updated>
        <content type="html"><![CDATA[<p>effect size实际上就是利用线性回归构建genetic data和phenotype之间关系的回归系数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span></span></span></span>。举个例子，比如不同genotype对height的影响，</p>
<blockquote>
<p>如果是logistic regression，则是odd ratio</p>
</blockquote>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>N</mi><msub><mi>P</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">SNP_{a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>出现时，对身高的影响可能是0.0001 cm；而<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>N</mi><msub><mi>P</mi><mi>b</mi></msub></mrow><annotation encoding="application/x-tex">SNP_{b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>出现时，则对身高的影响是-0.001 cm。这就体现出了不同的variants对身高的影响的效应不同和effect的方向性不同，而上述的数值简单理解就是对应了GWAS回归方程中的回归系数。</li>
</ul>
]]></content>
    </entry>
</feed>