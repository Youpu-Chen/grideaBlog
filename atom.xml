<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://chenyoupu.top</id>
    <title>有朴的第二大脑</title>
    <updated>2023-10-03T03:46:25.382Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://chenyoupu.top"/>
    <link rel="self" href="https://chenyoupu.top/atom.xml"/>
    <subtitle>Hi，这里是有朴的第二大脑。&lt;br/&gt;很高兴与你相遇</subtitle>
    <logo>https://chenyoupu.top/images/avatar.png</logo>
    <icon>https://chenyoupu.top/favicon.ico</icon>
    <rights>All rights reserved 2023, 有朴的第二大脑</rights>
    <entry>
        <title type="html"><![CDATA[「GWAS那些事儿」incomplete LD对heritability估计的影响]]></title>
        <id>https://chenyoupu.top/post/gwas-incomplete-LD/</id>
        <link href="https://chenyoupu.top/post/gwas-incomplete-LD/">
        </link>
        <updated>2023-10-03T03:43:49.000Z</updated>
        <content type="html"><![CDATA[<p>有一个前提假设：</p>
<ul>
<li><strong>一个<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>N</mi><msub><mi>P</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">SNP_{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>的效应往往是周围SNP效应之和</strong>，而这部分效应则自然由连锁不平衡决定</li>
</ul>
<p>我的理解，</p>
<ul>
<li>
<p>casual variants和SNP对phenotypic variation的贡献程度往往是不一样的，且casual variants本身的特点也与common variants不同，比如casual variants由于具有更高的effect，在群体中的frequecny不会太高，这是由于纯化选择的作用。</p>
</li>
<li>
<p><u>而不完全的连锁，则会导致所使用的SNP set对heritability的低估</u>。这部分是考虑到了casual variants和周围具有effect但不是casual的SNPs之间的linkage disequilibrium对SNP effect的影响</p>
</li>
<li>
<p>出处：番茄泛基因组文章</p>
<p>“Incomplete LD between molecular markers and causal variants leads to the underestimation of heritability9” (<a href="zotero://select/library/items/95NL8IPS">Zhou et al., 2022, p. 529</a>) (<a href="zotero://open-pdf/library/items/GFG9LQDC?page=3&amp;annotation=UGIFEHTS">pdf</a>)</p>
</li>
</ul>
<h2 id="举个例子">举个例子</h2>
<p>在2010年这篇文章中，Yang Jian老师对于casual variants与周围SNP的incomplete LD所产生的effect是这样描述以及做了如下的simulation的，</p>
<ul>
<li>
<p>将casual variants和common SNPs之间存在的<strong>incomplete LD</strong>导致的SNP effect bias estimation，记做<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>G</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">G_{jk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">A_{jk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>之间的差异，</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>G</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">G_{jk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>：基于casual variants所估计出来的effect</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">A_{jk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>：基于SNPs所估计出来的effect</li>
</ul>
<p>“Lack of complete LD is manifested as a difference between the genomic relationship between each pair of subjects j and k at the causal variants (Gjk) and the relationship between the same individuals calculated from the SNPs (Ajk).” (<a href="zotero://select/library/items/68BHI922">Yang et al., 2010, p. 2</a>) (<a href="zotero://open-pdf/library/items/ARYVNZTW?page=2&amp;annotation=GLD6745W">pdf</a>)</p>
</li>
<li>
<p>将SNP set划分为<strong>common variants set</strong>以及<strong>casual variants set</strong>。<br>
casual variants数据集中包含的variants，其频率<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>在0.1～05之间，作者构建的emprical <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span></span></span></span>（用于矫正<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">A_{jk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>）的计算公式为：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>−</mo><mfrac><mrow><mi>c</mi><mo>+</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>N</mi></mrow><mrow><mi>v</mi><mi>a</mi><mi>r</mi><mo>(</mo><msub><mi>A</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub><mo>)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">1-\frac{c+1/N}{var(A_{jk})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.55808em;vertical-align:-0.5480799999999999em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29011428571428566em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mord mtight">/</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5480799999999999em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<blockquote>
<p>c这个参数比较关键，通过不同的MAF casual variants set，估计出来的数值是不同的，其代表了对SNP effect的低估程度</p>
</blockquote>
</li>
<li>
<p>casual variants到底对common SNP的估计到底有怎么样的影响？</p>
<p>当casual variants的allele frequency threshold被设置为0.1时，矫正后的heritability为0.8（非常接近familial studies的研究结果）</p>
</li>
</ul>
<h2 id="写在后面">写在后面</h2>
<ul>
<li>在考虑associative SNP的真实effect时，需要考虑到的假设即，一个SNP的effect是周围SNP effect与自身effect的总和，因此就受到LD的影响。</li>
<li>“当casual variants的allele frequency threshold被设置为0.1时”，并不就代表casual variants的allele frequency就为0.1</li>
</ul>
<h2 id="参考资料">参考资料</h2>
<ul>
<li>Common SNPs explain a large proportion of the heritability for human height</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[「每日知识储备」molecular markrs]]></title>
        <id>https://chenyoupu.top/post/dailykg001/</id>
        <link href="https://chenyoupu.top/post/dailykg001/">
        </link>
        <updated>2023-10-02T15:05:06.000Z</updated>
        <content type="html"><![CDATA[<h1 id="molecular-markrs是什么">molecular markrs是什么？</h1>
<ul>
<li>
<p>指基因组上的一段区域、一段DNA。不同的语境也可以指代不同的意思，比如还可以指代为SNPs。</p>
<p>比如如下的这段话是Yang Jian老师10年的文章中提到的genotyepd SNP，但是在黄三文老师的22年的番茄泛基因组文章中则表述为了“molecular markers”</p>
<blockquote>
<p>果然，是我看的文献还不够多</p>
</blockquote>
<figure data-type="image" tabindex="1"><img src="https://youpu777-assets-1308187048.cos.ap-shanghai.myqcloud.com/siyuan-notes/20231002230342.png" alt="" loading="lazy"></figure>
</li>
<li>
<p>也可以称作genetic markers</p>
</li>
</ul>
<figure data-type="image" tabindex="2"><img src="https://youpu777-assets-1308187048.cos.ap-shanghai.myqcloud.com/siyuan-notes/20231002224303.png" alt="" loading="lazy"></figure>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[「GWAS那些事儿」数量遗传学应该关注谁的文章？]]></title>
        <id>https://chenyoupu.top/post/gwas-famous/</id>
        <link href="https://chenyoupu.top/post/gwas-famous/">
        </link>
        <updated>2023-10-02T14:20:34.000Z</updated>
        <content type="html"><![CDATA[<h1 id="写在前面">写在前面</h1>
<ul>
<li>持续更新</li>
</ul>
<ul>
<li>
<p>经过数十年的研究，GWAS已经证实了自己方法本身上的可行性</p>
</li>
<li>
<p>Peter M. Visscher（关于missing heritability的综述，就是这位大佬写的）</p>
</li>
<li>
<p>Yang Jian</p>
<ul>
<li>近期代表性工作：GCTA（可用于heritability estitation）</li>
</ul>
</li>
<li>
<p><a href="https://scholar.google.com/citations?hl=en&amp;user=9bqHVEsAAAAJ&amp;view_op=list_works&amp;sortby=pubdate">David J. Balding</a></p>
<ul>
<li>近期代表性工作：<a href="https://scholar.google.com/citations?view_op=view_citation&amp;hl=en&amp;user=9bqHVEsAAAAJ&amp;sortby=pubdate&amp;citation_for_view=9bqHVEsAAAAJ:QsaTk4IG4EwC">LDAK-GBAT</a></li>
</ul>
<figure data-type="image" tabindex="1"><img src="https://youpu777-assets-1308187048.cos.ap-shanghai.myqcloud.com/siyuan-notes/20231002221915.png" alt="" loading="lazy"></figure>
</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[「GWAS之外」TWAS（Transcriptome-Wide Association Study）]]></title>
        <id>https://chenyoupu.top/post/gwas-twas/</id>
        <link href="https://chenyoupu.top/post/gwas-twas/">
        </link>
        <updated>2023-10-02T14:13:33.000Z</updated>
        <content type="html"><![CDATA[<h2 id="twas">TWAS</h2>
<ul>
<li>
<p>FOCUS</p>
<p><a href="https://github.com/bogdanlab/focus">github.com/bogdanlab/foc...</a></p>
</li>
<li>
<p>FUSION</p>
<p><a href="http://gusevlab.org/projects/fusion/">gusevlab.org/projects/fu...</a></p>
</li>
</ul>
<h2 id="其他">其他</h2>
<h3 id="为什么要发展twas">为什么要发展TWAS？</h3>
<p>TWAS的发展是为了弥补GWAS的一些限制：</p>
<ol>
<li><strong>解释关联</strong>：GWAS虽然可以识别与性状或疾病相关的基因座，但通常无法提供这些关联的生物学解释。TWAS通过考虑基因表达数据，有助于更好地理解为什么某些基因与性状相关（SNP的存在是否影响了转录本层面的生物学机制）。</li>
<li><strong>功能注释</strong>：TWAS可以用于识别潜在的功能性基因。它不仅告诉我们哪些基因与性状相关，还可以帮助我们了解这些基因在性状或疾病发病机制中的具体角色。</li>
<li><strong>更精确的关联</strong>：TWAS可以提供更准确的关联信息，因为它结合了基因表达数据，减少了假阳性的可能性。</li>
</ol>
<p>总之，GWAS和TWAS是两种互补的遗传学方法，用于研究基因与性状或疾病之间的关系。TWAS的发展有助于增强我们对基因与性状之间关联的理解，并提供更多有关基因功能和生物学机制的信息。</p>
<h3 id="twas与ld之间的关系">TWAS与LD之间的关系？</h3>
<p>#GWAS#​TWAS statistics，在GWAS的基础上考虑了转录组的数据构建的统计量来找casual variants。但是TWAS仍旧会受到LD的影响。</p>
<ul>
<li>
<p>TWAS加入了expression weight，即具有<strong>类似expression weight</strong>（对同一类转录本有相似影响的SNPs，才能够被当作与目标表型的casual SNPs）。但是由于LD的影响，在计算最终TWAS signal时，周围non-casual SNPs由于LD的影响，也会具有和casual SNPs近似水平的association signal —— LD tagging effect</p>
</li>
<li>
<p>图解</p>
<figure data-type="image" tabindex="1"><img src="https://youpu777-assets-1308187048.cos.ap-shanghai.myqcloud.com/siyuan-notes/20231001204544.png" alt="" loading="lazy"></figure>
</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[「GWAS那些事儿」heritability的估计有哪些工具/模型？]]></title>
        <id>https://chenyoupu.top/post/gwas-heritability-estimate/</id>
        <link href="https://chenyoupu.top/post/gwas-heritability-estimate/">
        </link>
        <updated>2023-10-02T14:10:09.000Z</updated>
        <content type="html"><![CDATA[<h1 id="写在前面">写在前面</h1>
<ul>
<li>持续更新</li>
</ul>
<ul>
<li>
<p>LDSC：baseline LD model</p>
<p><a href="https://github.com/bulik/ldsc">github.com/bulik/ldsc</a></p>
</li>
<li>
<p>LDAK model</p>
<ul>
<li>
<p><a href="http://dougspeed.com/ldak/">dougspeed.com/ldak/</a>，官方series下载链接</p>
</li>
<li>
<p><a href="https://github.com/takiy-berrandou/LDAK-GBAT-paper-scripts">github.com/takiy-berrand...</a><br /></p>
</li>
<li>
<figure data-type="image" tabindex="1"><img src="https://youpu777-assets-1308187048.cos.ap-shanghai.myqcloud.com/siyuan-notes/20231002220845.png" alt="" loading="lazy"></figure>
</li>
</ul>
</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[「GWAS那些事儿」heritability和genetic correlation估计中的liability scale]]></title>
        <id>https://chenyoupu.top/post/gwas-liability-scale/</id>
        <link href="https://chenyoupu.top/post/gwas-liability-scale/">
        </link>
        <updated>2023-10-02T11:34:52.000Z</updated>
        <content type="html"><![CDATA[<p><strong>liability scale是什么</strong>？</p>
<p>the &quot;liability scale&quot; refers to a hypothetical scale used to model the underlying genetic liability or genetic risk for a specific trait or disease.</p>
<figure data-type="image" tabindex="1"><img src="https://youpu777-assets-1308187048.cos.ap-shanghai.myqcloud.com/siyuan-notes/20231002175826.png" alt="" loading="lazy"></figure>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[「GWAS那些事儿」linear regression中的Z-Score]]></title>
        <id>https://chenyoupu.top/post/gwas-zscore/</id>
        <link href="https://chenyoupu.top/post/gwas-zscore/">
        </link>
        <updated>2023-10-02T11:33:43.000Z</updated>
        <content type="html"><![CDATA[<ul>
<li>
<p><strong>Z-score在GWAS summary statistics中的含义是什么</strong>？</p>
<p>The Z-score quantifies how many standard deviations an observed association statistic is from the expected null distribution under the assumption of no association.</p>
<ol>
<li>
<p><strong>Association Testing</strong>: In a GWAS, genetic variants across the genome are tested for their association with a particular trait or disease. The most common statistical test used for this purpose is logistic regression for binary traits (e.g., disease status) or linear regression for continuous traits (e.g., height).</p>
</li>
<li>
<p><strong>Z-Score Calculation</strong>: After performing the association test for each SNP, a Z-score is calculated for that SNP. The formula for calculating the Z-score is typically as follows:</p>
<pre><code class="language-shell">Z = (β - β₀) / SE
</code></pre>
<ul>
<li><code>Z</code> is the Z-score.</li>
<li><code>β</code> is the estimated effect size or regression coefficient for the SNP, representing the change in the trait value associated with each additional copy of the variant.</li>
<li><code>β₀</code> is the null hypothesis value for <code>β</code>, often assumed to be zero under the null hypothesis of no association.</li>
<li><code>SE</code> is the standard error of the estimated effect size <code>β</code>.</li>
</ul>
</li>
<li>
<p><strong>Interpretation</strong>: The Z-score measures how many standard deviations (<code>SE</code>) the estimated effect size (<code>β</code>) is away from the null hypothesis value (<code>β₀</code>). A high absolute Z-score indicates a strong association between the SNP and the trait, whereas a low or close-to-zero Z-score suggests a weak or no association.</p>
</li>
<li>
<p><strong>Significance Threshold</strong>: Researchers typically establish a significance threshold (e.g., Z-score greater than 5 or corresponding p-value threshold) to determine which associations are statistically significant. Associations with Z-scores exceeding this threshold are considered noteworthy and may indicate a genuine genetic influence on the trait or disease.</p>
</li>
<li>
<p><strong>Positive and Negative Z-Scores</strong>: The sign of the Z-score indicates the direction of the effect. A positive Z-score suggests that the variant is positively associated with an increase in the trait (e.g., risk allele for a disease). A negative Z-score suggests a negative association (e.g., protective allele for a disease).</p>
</li>
</ol>
</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[「GWAS那些事儿」LDSC｜LD Score的计算与LD regression构建]]></title>
        <id>https://chenyoupu.top/post/gwas-ldsc/</id>
        <link href="https://chenyoupu.top/post/gwas-ldsc/">
        </link>
        <updated>2023-10-02T11:27:59.000Z</updated>
        <content type="html"><![CDATA[<h2 id="写在前面">写在前面</h2>
<ul>
<li>
<p><strong>什么是LD score</strong>?</p>
<ul>
<li>LD Score衡量了target region的genetic correlation</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>N</mi><msub><mi>P</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">SNP_{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>的LD score可以被定义为该SNP与一定范围内其他SNP的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">r^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>之和。​ LD score衡量了该SNP标记的遗传变异性的大小。</li>
</ul>
</li>
<li>
<p><strong>为什么需要开展LD regression analysis</strong>？</p>
<ul>
<li>
<p>在GWAS研究中，多基因性（polygenicity，即若干较小的基因效应）和干扰因素引起的偏差（e.g.，隐性关联 cryptic relatedness，群体分层 population stratification等）都会造成检验的统计量的分布偏高（inflated）</p>
<blockquote>
<ul>
<li>
<p><strong>统计量指什么</strong>？即经过卡方检验检验得到的对应SNP对目标表型的作用，用<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\chi^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">χ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>来衡量</p>
</li>
<li>
<p>造成association signal（SNP）对应的统计量分布偏高，是否是真的对目标表型有显著作用（有如此高的作用）？</p>
<p><u>如何将这部分不知道由于是polygenicity造成，还是由populaton stratification等不准确因素造成的effect给估计出来</u>？答案：LD regression（实际上还有很多别的模型来做这这个heritability估计）</p>
</li>
</ul>
</blockquote>
</li>
<li>
<p>通过LD score regression，我们可以通过研究检验统计量与连锁不平衡（linkage disequilibrium）之间的关系来定量分析每部分的影响，即对干扰因素平均效应的<strong>估计值</strong>进行计算</p>
</li>
</ul>
</li>
<li>
<p><strong>LD Score的计算原理是什么</strong>？</p>
<p>GWAS检验中，对一个SNP效应量的估计通常也会包含与该SNP成LD的其他SNP的效应，也就是说一个与其他SNP呈现高LD的SNP，通常也会有更高的卡方检验量。</p>
</li>
<li>
<p><strong>LD regression的原理是什么</strong>？</p>
<figure data-type="image" tabindex="1"><img src="https://youpu777-assets-1308187048.cos.ap-shanghai.myqcloud.com/siyuan-notes/20231002180236.png" alt="" loading="lazy"></figure>
</li>
</ul>
<h2 id="ldsc安装">LDSC｜安装</h2>
<ul>
<li>M1芯片不支持（因为LDSC基于Python 2.7）</li>
<li>推荐在Server或者Win虚拟机上运行</li>
</ul>
<pre><code class="language-shell">git clone https://github.com/bulik/ldsc.git
cd ldsc
mamba env create --file environment.yml
mamba activate ldsc
</code></pre>
<h2 id="ldscld-score-calculation">LDSC｜LD Score Calculation</h2>
<ul>
<li>
<p>输入文件：要求PLINK处理过后的genotype数据</p>
<p><code>.bed/.bim/.fam</code>作为输入文件，可以使用PLINK VCF来生成</p>
</li>
<li>
<p>作者推荐的LD Score估计遗传范围（选择用于计算LD Score遗传距离的窗口）：1 centiMorgan (cM) window</p>
<p>可以使用<code>plink --cm-map</code>来保留遗传距离</p>
</li>
<li>
<p>在针对MHC等复杂区域（e.g.，LD延展度更高的region），需要设置更大的window size；具有比较高的recombination rate就不需要设置太大的window size</p>
<p>It is sensible to use a larger window (as measured in kb) in regions like the MHC where LD spans over tens of megabases than in regions with high recombination rate, where LD doesn't extend beyond ~100kb.</p>
</li>
</ul>
<p>以LDSC官方提供的<code>1kg_eur.tar.bz2</code>来说明toy data的结果。</p>
<h3 id="01univariate-ld-score">01）Univariate LD Score</h3>
<pre><code class="language-shell">python ldsc.py\
	--bfile\
	--l2\ 
	--ld-wind-cm 1\ 
	--out 22
</code></pre>
<ul>
<li><code>--l2</code>，指示计算LD Score</li>
<li><code>--ld-wind-cm</code>代表选择的window size（基于遗传距离），还可以直接基于物理距离、SNP个数等</li>
</ul>
<h4 id="结果文件解读">结果文件解读</h4>
<h5 id="122log">1）22.log</h5>
<ul>
<li>
<p>包含所使用的cml以及基本运行结果，</p>
<pre><code class="language-shell">Beginning analysis at Fri Jan 30 10:58:44 2015
Read list of 19156 SNPs from 22.bim
Read list of 379 individuals from 22.fam
Reading genotypes from 22.bed
After filtering, 19156 SNPs remain
～～～Estimating LD Score.～～～
Writing LD Scores for 19156 SNPs to 22.l2.ldscore.gz
</code></pre>
</li>
</ul>
<h5 id="222l2m-22l2m_5_50">2）<code>22.l2.M</code>, <code>22.l2.M_5_50</code></h5>
<ul>
<li>
<p>第一个文件包含了目标region所包含的SNP数目</p>
</li>
<li>
<p>第二个文件包含了过滤MAF（&gt;5%）的SNP数目</p>
<blockquote>
<p>LDSC一般基于后者来进行heritability的估计</p>
</blockquote>
</li>
</ul>
<h5 id="322l2ldscoregz">3）22.l2.ldscore.gz</h5>
<ul>
<li>CHR：chromosome number</li>
<li>SNP：variantID</li>
<li>BP：LDSC自动对variantID对应的物理位置进行排序</li>
</ul>
<pre><code class="language-shell">gunzip -c 22.l2.ldscore.gz | head 

CHR SNP	        BP	        L2
22	rs9617528	16061016	1.271
22	rs4911642	16504399	1.805
22	rs140378	16877135	3.849
22	rs131560	16877230	3.769
22	rs7287144	16886873	7.226
22	rs5748616	16888900	7.379
22	rs5748662	16892858	7.195
22	rs5994034	16894090	2.898
22	rs4010554	16894264	6.975
</code></pre>
<h3 id="02partitioned-ld-score">02）Partitioned LD Score</h3>
<ul>
<li>略</li>
</ul>
<h2 id="ldscld-regression">LDSC｜LD regression</h2>
<p>需要的输入文件，</p>
<ul>
<li>GWAS summary statistics</li>
<li>计算好的LD Score（需要针对对应的人群进行计算）</li>
</ul>
<p>结果文件解读包含：heritability、genetic correlation、LD regression估计出来的intercetp（衡量了polygenicity之外的因素对SNP effect的影响）等</p>
<h3 id="01genetic-correlation-heritability">01）genetic correlation &amp; heritability</h3>
<h4 id="1数据下载-格式转换">1）数据下载 &amp; 格式转换</h4>
<pre><code class="language-shell"># 
wget www.med.unc.edu/pgc/files/resultfiles/pgc.cross.bip.zip
wget www.med.unc.edu/pgc/files/resultfiles/pgc.cross.scz.zip
wget https://data.broadinstitute.org/alkesgroup/LDSCORE/eur_w_ld_chr.tar.bz2
wget https://data.broadinstitute.org/alkesgroup/LDSCORE/w_hm3.snplist.bz2

# 由于GWAS summary statistics不能直接用于ldsc的计算，需要转换
munge_sumstats.py \
--sumstats pgc.cross.SCZ17.2013-05.txt \
--N 17115 \
--out scz \
--merge-alleles w_hm3.snplist

munge_sumstats.py \
--sumstats pgc.cross.BIP11.2013-05.txt \
--N 11810 \
--out bip \
--merge-alleles w_hm3.snplist
</code></pre>
<ul>
<li>
<p>转换之后生成<code>.log</code>文件，包含的信息：使用的命令以及header对应的信息以及对summary statistics过滤的condition信息</p>
<ul>
<li>一般的过滤条件：<code>INFO &gt; 0.9, MAF &gt; 0.01 and 0 &lt; P &lt;= 1.</code>，去除了INDELs、strand ambiguous SNPs、SNPs with duplicated rs numbers</li>
</ul>
</li>
<li>
<p>log文件的最后一部分给出了summary statistics的meta信息，</p>
<pre><code class="language-plaintext">Metadata:
Mean chi^2 = 1.229
Lambda GC = 1.201
Max chi^2 = 32.4
11 Genome-wide significant SNPs (some may have been removed by filtering).

Conversion finished at Mon Apr  4 13:21:29 2016
Total time elapsed: 16.07s 
</code></pre>
</li>
<li>
<p>举个例子，</p>
<pre><code class="language-plaintext">Reading list of SNPs for allele merge from w_hm3.snplist
Read 1217311 SNPs for allele merge.
Reading sumstats from pgc.cross.SCZ17.2013-05.txt into memory 5000000.0 SNPs at a time.
Read 1237958 SNPs from --sumstats file.
Removed 137131 SNPs not in --merge-alleles.
Removed 0 SNPs with missing values.
Removed 256286 SNPs with INFO &lt;= 0.9.
Removed 0 SNPs with MAF &lt;= 0.01.
Removed 0 SNPs with out-of-bounds p-values.
Removed 2 variants that were not SNPs or were strand-ambiguous.
844539 SNPs remain.
Removed 0 SNPs with duplicated rs numbers (844539 SNPs remain).
Using N = 17115.0
Median value of or was 1.0, which seems sensible.
Removed 39 SNPs whose alleles did not match --merge-alleles (844500 SNPs remain).
Writing summary statistics for 1217311 SNPs (844500 with nonmissing beta) to scz.sumstats.gz.
</code></pre>
</li>
</ul>
<h4 id="2遗传力估计-遗传相关性估计">2）遗传力估计 + 遗传相关性估计</h4>
<pre><code class="language-shell"># rg
ldsc.py \
--rg scz.sumstats.gz,bip.sumstats.gz \
--ref-ld-chr eur_w_ld_chr/ \
--w-ld-chr eur_w_ld_chr/ \
--out scz_bip

# h2
ldsc.py \
--h2 scz.sumstats.gz \
--ref-ld-chr eur_w_ld_chr/ \
--w-ld-chr eur_w_ld_chr/ \
--out scz_h2
</code></pre>
<h4 id="参数解读">参数解读</h4>
<ul>
<li>
<p><code>--rg</code>，计算genetic correlation（作者给出的例子中直接以SCZ和bipolar为例）</p>
<ul>
<li>
<p>与使用<code>--h2</code>来计算得到的heritability存在不同</p>
</li>
<li>
<p>作者对此的解释：总的来说就是所使用的SNP dataset不同，rg由于需要同时计算genetic correlation，所以并不是直接使用对应表型的SNP dataset</p>
<figure data-type="image" tabindex="2"><img src="https://youpu777-assets-1308187048.cos.ap-shanghai.myqcloud.com/siyuan-notes/20231002171737.png" alt="" loading="lazy"></figure>
</li>
</ul>
</li>
<li>
<p><code>--w-ld</code>｜<code>--w-ld-chr</code>，在进行<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>N</mi><msub><mi>P</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">SNP_{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>的LD回归的估算时，理论上要考虑到该SNP和别的SNP的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">r^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>之和，但是在实际中LD回归对SNP的权重不敏感，所以使用<code>--ref-ld-chr</code>即可</p>
</li>
</ul>
<h4 id="结果解读">结果解读</h4>
<ul>
<li>
<p>以<code>--rg</code>的分析结果为例</p>
<ul>
<li>
<p>Lambda GC，代表了估计结果受到population stratification的影响程度</p>
<p>计算公式：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>a</mi><mi>m</mi><mi>b</mi><mi>d</mi><mi>a</mi><mtext> </mtext><mtext> </mtext><mi>G</mi><mi>C</mi><mo>=</mo><mfrac><mrow><mi>m</mi><mi>e</mi><mi>d</mi><mi>i</mi><mi>a</mi><mi>n</mi><mtext> </mtext><mtext> </mtext><mi>c</mi><mi>h</mi><msup><mi>i</mi><mn>2</mn></msup></mrow><mn>0.4549</mn></mfrac></mrow><annotation encoding="application/x-tex">lambda\,\,GC=\frac{median\,\,chi^{2}}{0.4549}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">b</span><span class="mord mathdefault">d</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.36292em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01792em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mord mtight">.</span><span class="mord mtight">4</span><span class="mord mtight">5</span><span class="mord mtight">4</span><span class="mord mtight">9</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">n</span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">h</span><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，</p>
<ul>
<li>
<p>0.4549，the expected median of a variable from the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>χ</mi><mn>1</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\chi^{2}_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0622159999999998em;vertical-align:-0.24810799999999997em;"></span><span class="mord"><span class="mord mathdefault">χ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span></span></span></span> distribution</p>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4406348/">www.ncbi.nlm.nih.gov/pmc...</a></p>
</li>
</ul>
</li>
<li>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\chi^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">χ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>，通过比较case和control中的genotype得到的卡方统计量</p>
<blockquote>
<ul>
<li>by comparing the observed genotype frequencies in cases (individuals with the trait or disease) and controls (individuals without the trait or disease).</li>
<li>The chi-square statistic measures the extent to which the observed genotype frequencies deviate from what would be expected under the null hypothesis of no association between the SNP and the trait.</li>
</ul>
</blockquote>
</li>
<li>
<p><code>Intercept</code>，the LD Score regression intercept</p>
</li>
<li>
<p>Ratio（<em>attenuation ratio</em>）：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>c</mi><mi>e</mi><mi>p</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>m</mi><mi>e</mi><mi>a</mi><mi>n</mi><mo>(</mo><mi>c</mi><mi>h</mi><msup><mi>i</mi><mn>2</mn></msup><mo>)</mo><mo>−</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{intercept-1}{mean(chi^2)-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.427772em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.907772em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">n</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">h</span><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，用于衡量在LD regression中，polygenicity之外的因素对（理想情况下，应为0）SNP effect的影响（<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>e</mi><mi>a</mi><mi>n</mi><mtext> </mtext><mtext> </mtext><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">mean\,\,\chi^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">χ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>）</p>
</li>
</ul>
</li>
</ul>
<pre><code class="language-shell">Heritability of phenotype 1
---------------------------
Total Observed scale h2: 0.5907 (0.0484)
Lambda GC: 1.2038
Mean Chi^2: 1.2336
Intercept: 1.0014 (0.0113)
Ratio: 0.0059 (0.0482)

Heritability of phenotype 2/2
-----------------------------
Total Observed scale h2: 0.5221 (0.0531)
Lambda GC: 1.1364
Mean Chi^2: 1.1436
Intercept: 1.0013 (0.0094)
Ratio: 0.0093 (0.0652)
</code></pre>
<ul>
<li>
<p>genetic covariance：</p>
<pre><code class="language-shell">Genetic Covariance
------------------
Total Observed scale gencov: 0.3644 (0.0368)
Mean z1*z2: 0.1226
Intercept: 0.0037 (0.0071)
</code></pre>
</li>
<li>
<p>genetic correlaton：</p>
<pre><code class="language-shell">Genetic Correlation
-------------------

Genetic Correlation: 0.6561 (0.0605)
Z-score: 10.8503
P: 1.9880e-27
</code></pre>
</li>
</ul>
<h3 id="02将heritability结果转换到liability-scale">02）将heritability结果转换到liability scale</h3>
<ul>
<li>
<p>由于ldsc估计出来的heritability是obseved scale，为了研究之间的可比较性，需要转换到liability scale，</p>
<pre><code class="language-shell">ldsc.py \
--rg scz.sumstats.gz,bip.sumstats.gz \
--ref-ld-chr eur_w_ld_chr/ \
--w-ld-chr eur_w_ld_chr/ \
--out scz_bip \
--samp-prev 0.5,0.5 \
--pop-prev 0.01,0.01
</code></pre>
</li>
</ul>
<h2 id="参考资料">参考资料</h2>
<ul>
<li><a href="https://github.com/bulik/ldsc/wiki/LD-Score-Estimation-Tutorial#univariate-ld-scores">LDSC：LD Score的计算</a></li>
<li><a href="https://github.com/bulik/ldsc/wiki/Heritability-and-Genetic-Correlation">LDSC：heritability + genetic correlation的估计</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/379628546">GWAS Lab：LDSC原理</a></li>
<li><a href="https://gwaslab.org/2022/04/04/ld-score/">GWAS Lab：LDSC计算LD Scores</a></li>
</ul>
<h2 id="资源">资源</h2>
<ul>
<li><a href="https://zenodo.org/record/7768714">zenodo.org/record/776871...</a></li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[「有谱talk」002｜遇到问题，解决问题]]></title>
        <id>https://chenyoupu.top/post/youputalk002/</id>
        <link href="https://chenyoupu.top/post/youputalk002/">
        </link>
        <updated>2023-09-30T15:43:50.000Z</updated>
        <content type="html"><![CDATA[<h2 id="写在前面">写在前面</h2>
<ul>
<li>
<p>虽然嘴上说着要碰到问题解决问题，但是发现自己好像总是热衷于解决知识上的问题，但是在人际关系上的问题，自己却更倾向于逃避。这一类问题对我来说，又或者说对现在的我来说太难了</p>
</li>
<li>
<p>个人事务上遇到很大的困境，不知该如何解决，所以总是会选择逃避，或者间断性地麻痹自己</p>
</li>
<li>
<p>同时又喜欢在人面前“证明”自己，所谓的成熟，害怕别人如何看待我，觉得我不成熟，但是我不成熟和他人有什么关系？所以现在总在学习赤焰男孩，“nobody cares，我就是我自己世界的王”</p>
<p>但是我也的确发现自己的不成熟，对自己的职业发展不够上心，收集行政事务上的信息、与行政上的人沟通等，这些都是我的弱项，需要在往后的生活中锻炼。</p>
</li>
</ul>
<p>“nobody cares，我就是我自己世界的王”，蛮有意思，自我一点，但是不是自我意识过剩一点。</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[「有谱音乐说」001｜我是个“健将”]]></title>
        <id>https://chenyoupu.top/post/you-pu-yin-le-shuo-001orwo-shi-ge-jian-jiang/</id>
        <link href="https://chenyoupu.top/post/you-pu-yin-le-shuo-001orwo-shi-ge-jian-jiang/">
        </link>
        <updated>2023-09-30T09:21:13.000Z</updated>
        <content type="html"><![CDATA[<p>我是冷静的</p>
<p>稳定的</p>
<p>从来不任性的</p>
<p>把水端得最平的</p>
<p>不配赢的</p>
<p>站错了队形的</p>
<p>如影随形的破事</p>
<p>哪怕永远不会停</p>
<p>不撕破脸</p>
<p>我会难为情的</p>
<p>我要深刻</p>
<p>要厚重</p>
<p>要工整</p>
<p>不能有漏洞</p>
<p>要说个道理</p>
<p>我要你用效率去对抗虚无</p>
<p>套上件最花的衣服</p>
<p>却排不出体内的瘀毒</p>
<p>我做不到</p>
<p>羞愧于纯粹的快乐</p>
<p>不敢直说我爱着</p>
<p>我不是品</p>
<p>我就是爱喝</p>
<p>押多少才能算合格</p>
<p>都在笑堂吉诃德</p>
<p>为什么作者写窗帘是蓝色的</p>
<p>因为它就是蓝色的</p>
<p>我做不到</p>
<p>我真的在努力去克制</p>
<p>保持我 I内向人的特质</p>
<p>自己对自己呵斥</p>
<p>可我真的需要一首歌的时间放空</p>
<p>我不在乎这是比赛</p>
<p>我要“发疯”</p>
]]></content>
    </entry>
</feed>